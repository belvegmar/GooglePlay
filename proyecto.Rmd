---
title: "GooglePlay"
author: "Belen_Miguel"
date: "18 de diciembre de 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, include=FALSE}
#install.packages(c("plyr"))
library("plyr")
```

# Lectura de los datos
```{r cars}
datos <- read.csv(file="googleplaystore.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)

```

# Echamos un vistazo al dataset
```{r}
str(datos)

```





# Limpieza de datos y transformación

El primer paso será hacer un preprocesamiento de cada uno de los atributos con vista a obtener mejores resultados en los algoritmos de minería de datos

## Identificar valores nulos
```{r}
sapply(datos, function (x) sum(is.nan(x)))
```

## Borrar filas con valores nullos o NaNs
```{r}
datos <- na.omit(datos)
```

## Volvemos a comprobar valores nulos removidos
```{r}
sapply(datos, function (x) sum(is.nan(x)))
```



## Size

Se puede ver que los datos tienen prefijos métricos (Kilo y Mega) junto con otra cadena. Reemplazando K y M con sus valores para convertir valores a números.
- Sustitución de 'Varía con el dispositivo' por nan y
- Convertir 1000+ a 1000, para hacerlo numérico.

```{r}
print(head(datos$Size))
```


```{r}
for (i in 1:length(datos$Size)) { 
  if(grepl("M",datos$Size[i])){
    numero <- as.numeric(gsub("M", "e+06", datos$Size[i]))
    datos$Size[i]<- numero
  } else if (grepl("k", datos$Size[i])){
    numero <- as.numeric(gsub("k", "e+03", datos$Size[i]))
    datos$Size[i] <- numero
  }else if (grepl("Varies", datos$Size[i])){
    datos$Size[i] <- NaN
  }else{
    datos$Size[i]<-1000
  }
}

datos$Size <- as.numeric(datos$Size)

print(head(datos$Size))

```

## Reviews
Comprobaremos si los valores del atributo "Reviews" son de tipo numérico:
```{r}
datos$Reviews <- as.numeric(datos$Reviews)

```
Se puede observar que al convertir la columna a número, un valor no se ha podido convertir, ya que no había forma. Daremos un vistazo previo a esta fila:
```{r}
for (i in 1:length(datos$Reviews)) {
  if(is.na(datos$Reviews[i])){
    print(i)
    print(datos[i,])
    datos <- datos[-i,]
    
  }
}

print(datos[10471:10480,])

```
Como solo es una fila, se optará por eliminarla directamente. En la representación de arriba se ve cómo ha desaparecido del dataframe.

## Convertir "Installs" en numeric
Removemos el simbolo de mas (+) y luego convertimos a numerico. Comprobamos los cambios.

```{r}
datos$Installs <- as.numeric(gsub(",", "", gsub("+", "", datos$Installs, fixed = TRUE), fixed=TRUE))
options("scipen"=100, "digits"=4)
str(datos$Installs)
print(unique(datos$Installs))
```


## Price
```{r}
print(unique(datos$Price))
```
Se puede observar que la variable precio tiene un carácter $ que hay que eliminar para poder convertirlo en número. Además, hay varias columnas que tienen valores raros, estas filas las eliminaremos
```{r}
for (i in 1:length(datos$Price)){
  datos$Price[i] <- as.numeric((gsub("\\$","", datos$Price[i])))
}
#Eliminar valores NAN
for (i in 1:length(datos$Price)){
  if(is.na(datos$Price[i])){
    print(i)
    print(datos[i,])
    datos <- datos[-i,]
    
  }
}

```
Lo más curioso es que hay aplicaciones que superan los 350 dólares, tal como se puede ver a continuación:
```{r}
hist(as.numeric(datos$Price), col="blue1")
for (i in 1:length(datos$Price)){
  if(as.numeric(datos$Price[i])>350){
    print(datos[i,])
  }
}

```

